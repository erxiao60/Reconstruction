'''
 *  $Id: SConstruct, 2014-10-19 09:43:16+08:00 DAMPE $
 *----------------------------------------------------------
 *  This file is generated by dmpse-expand
 *----------------------------------------------------------
'''

import os

target='DmpEvtBgoPID'

print "---> compiling: %s\n" % target
#--------------------------------------------------------------------
# environment
env = Environment(ENV = os.environ)
#env.ParseConfig("dmpsw-config --include")
env.ParseConfig("root-config --cflags --libs")

#-------------------------------------------------------------------
# include dir. and external libs
env.Prepend(CPPPATH=['./include'])

# installation
prefix=os.environ['DMPSWWORK']
#--------------------------------------------------------------------
for tmp in os.listdir('./include'):
    if "." not in tmp[0] and "LinkDef" not in tmp and "Dictionary" not in tmp and ".h" in tmp:
        Default(Command(prefix+'/include/'+tmp,'./include/'+tmp,Copy("$TARGET","$SOURCE")))

#-------------------------------------------------------------------
# main build
goal=env.SharedLibrary(target,Glob('./src/*.cc'))
Default(env.InstallAs(prefix+'/lib/lib'+target+".so",goal))
if env['PLATFORM'] == 'darwin':    #MacOS
    Default(env.InstallAs(prefix+'/lib/lib'+target+".dylib",goal))

